2016/04/19 17:06:27  TRACE> LogicEXTA0101.GetConfigrationFlg() START
2016/04/19 17:06:27  TRACE> LogicEXTA0101.GetConfigrationFlg() END
2016/04/19 17:06:27  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:06:27  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:06:36  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:06:36  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:06:36  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:06:36  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:06:36  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:06:36  TRACE> LogicEXTA0101.LoginInputCheck() START
2016/04/19 17:06:36  TRACE> LogicEXTA0101.LoginInputCheck() END
2016/04/19 17:06:36  TRACE> LogicEXTA0101.GetLoginData() START
2016/04/19 17:06:36  TRACE> SqlEXTA0101.setSelectLoginData() START
2016/04/19 17:06:36  TRACE> SqlEXTA0101.setSelectLoginData() END
2016/04/19 17:06:36  DEBUG> LogicEXTA0101.GetLoginData() ログイン情報取得
■SQL Data :
   Sql Command > select 
USER_NM, 
MAIL, 
BUSHO_CD, 
SHONIN_FLG, 
MST_FLG 
FROM 
USER_MST 
WHERE
USER_CD = :UserId 
and PW = :Password 
and STS = '0' 
   Parameters Data > 
      [:UserId] USN001
      [:Password] password
2016/04/19 17:06:36  TRACE> LogicEXTA0101.GetLoginData() END
2016/04/19 17:06:36  TRACE> LogicEXTA0101.DelYoyakuCtlData() START
2016/04/19 17:06:36  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc1
■SQL Data :
   Sql Command > DELETE 
FROM 
YCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] USN001
2016/04/19 17:06:36  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc2
■SQL Data :
   Sql Command > DELETE 
FROM 
CCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] USN001
2016/04/19 17:06:36  TRACE> LogicEXTA0101.DelYoyakuCtlData() END
2016/04/19 17:06:36  TRACE> LogicEXTA0101.SetSystemProperties() START
2016/04/19 17:06:36  TRACE> SqlEXTA0101.setSelectSystemProperty() START
2016/04/19 17:06:36  TRACE> SqlEXTA0101.setSelectSystemProperty() END
2016/04/19 17:06:36  DEBUG> LogicEXTA0101.SetSystemProperties() システムプロパティ取得
■SQL Data :
   Sql Command > select 
TEIIN_A, 
TEIIN_B, 
KARI_JIZEN_TUTI, 
GROUP_SEIKYU 
FROM 
SYSTEM_MST 
   Parameters Data > 
2016/04/19 17:06:36  TRACE> LogicEXTA0101.SetSystemProperties() END
2016/04/19 17:06:36  TRACE> EXTA0101.btnLogin_Click() LOGIN:USN001
2016/04/19 17:06:36  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:06:36  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:06:48  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:06:48  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:06:48  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:06:48  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:06:48  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:06:48  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:06:48  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:06:59  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:06:59  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:06:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:06:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:06:59  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:06:59  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:06:59  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:06:59  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:06:59  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:06:59  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00108' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:06:59  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:06:59  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:07:01  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:01  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:01  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:01  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:01  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:01  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:07:01  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:07:01  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:07:01  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:07:01  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:07:01  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetApproval() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectApprovalReq() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectApprovalReq() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectApprovalRes() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectApprovalRes() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetApproval() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTimeSchedule() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectTimeSch() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectTimeSch() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetTimeSchedule() タイムスケジュール情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    shurui, 
    time, 
    biko 
FROM 
    time_schedule_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY time 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTimeSchedule() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTicketInfo() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectTicket() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectTicket() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetTicketInfo() チケット情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    ticket_nm, 
    ticket_kin 
FROM 
    ticket_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTicketInfo() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetFutai() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectFutaiHeadder() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectFutaiHeadder() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '1' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00108
      [:Riyobi] 2016/01/09
      [:ShisetuKbn] 1
      [:SYANAI] 1
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectFutaiDetail() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectFutaiDetail() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] T00108
      [:ShisetuKbn] 1
      [:Riyobi] 2016/01/09
      [:SYANAI] 1
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetFutai() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTax() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectTax() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectTax() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTax() TAX = 0.08
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetTax() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetBillReq() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectBillReq() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectBillReq() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetBillReq() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetExasRiyoryo() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectExasRiyoryo() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectExasRiyoryo() END
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectExasFutai() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectExasFutai() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t1.shukei_grp ASC 
   Parameters Data > 
      [:YoyakuNo] T00108
      [:SeikyuIraiNo] E02079
      [:ShisetuKbn] 1
      [:Riyobi] 
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetExasRiyoryo() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetNyukin() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND nyukin_link_no = '45' 

   Parameters Data > 
      [:LineNo] 2
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetNyukin() END
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetCashAndElectroMoney() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectCashElectro() START
2016/04/19 17:07:01  TRACE> SqlEXTB0103.selectCashElectro() END
2016/04/19 17:07:01  DEBUG> LogicEXTB0103.GetCashAndElectroMoney() 現金電子マネー情報取得
■SQL Data :
   Sql Command > SELECT  DISTINCT 
    t2.regi_nm, 
    t3.tenpo_nm, 
    t1.deposit_amount 
FROM  ( SELECT 
            yoyaku_no, 
            register_cd, 
            SUM(deposit_amount) deposit_amount 
        FROM  ALSOK_DEPOSIT_TBL 
        GROUP BY 
            yoyaku_no, 
            register_cd 
      ) t1 
  LEFT OUTER  JOIN  ALSOK_DEPOSIT_TBL t0 
        ON  t1.yoyaku_no   = t0.yoyaku_no 
        AND t1.register_cd = t0.register_cd 
  LEFT JOIN  ALSOK_TENPO_MST t2 
        ON  t1.register_cd = t2.regi_cd 
  LEFT JOIN  TENPO_MST t3 
        ON  t0.tenpo_cd = t3.tenpo_cd 
WHERE 
    t1.yoyaku_no = :YoyakuNo 
ORDER BY 
    t2.regi_nm
   Parameters Data > 
      [:YoyakuNo] T00108
2016/04/19 17:07:01  TRACE> LogicEXTB0103.GetCashAndElectroMoney() END
2016/04/19 17:07:01  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:07:01  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:07:01  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:07:01  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:07:01  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:07:10  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:10  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:07:10  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:07:10  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:10  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:10  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:07:10  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:07:11  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:11  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:11  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:11  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:11  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:11  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:07:11  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:07:11  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:07:11  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:07:11  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00108' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:07:11  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:07:11  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:07:15  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:15  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:15  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:15  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:15  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:15  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:07:15  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:07:15  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:07:15  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:07:15  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00118' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:07:15  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:07:15  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:07:17  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:17  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:17  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:17  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:17  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:17  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:07:17  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:07:17  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:07:17  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:07:17  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:07:17  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetApproval() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectApprovalReq() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectApprovalReq() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectApprovalRes() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectApprovalRes() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetApproval() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTimeSchedule() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectTimeSch() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectTimeSch() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetTimeSchedule() タイムスケジュール情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    shurui, 
    time, 
    biko 
FROM 
    time_schedule_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY time 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTimeSchedule() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTicketInfo() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectTicket() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectTicket() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetTicketInfo() チケット情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    ticket_nm, 
    ticket_kin 
FROM 
    ticket_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTicketInfo() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetFutai() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectFutaiHeadder() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectFutaiHeadder() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '1' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00118
      [:Riyobi] 2015/12/21
      [:ShisetuKbn] 1
      [:SYANAI] 1
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectFutaiDetail() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectFutaiDetail() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] T00118
      [:ShisetuKbn] 1
      [:Riyobi] 2015/12/21
      [:SYANAI] 1
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetFutai() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTax() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectTax() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectTax() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTax() TAX = 0.08
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetTax() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetBillReq() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectBillReq() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectBillReq() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetBillReq() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetExasRiyoryo() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectExasRiyoryo() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectExasRiyoryo() END
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectExasFutai() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151217
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151217
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectExasFutai() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t1.shukei_grp ASC 
   Parameters Data > 
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetExasRiyoryo() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetNyukin() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND yoyaku_no = 'T00118' 
AND seikyu_irai_no = 'E01771' 
AND nyukin_link_no = (select MIN(nyukin_link_no) FROM exas_nyukin_tbl WHERE nyukin_dt = (select MIN(nyukin_dt) FROM exas_nyukin_tbl WHERE seikyu_irai_no = 'E01771') and seikyu_irai_no = 'E01771')

   Parameters Data > 
      [:LineNo] 2
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetNyukin() END
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetCashAndElectroMoney() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectCashElectro() START
2016/04/19 17:07:17  TRACE> SqlEXTB0103.selectCashElectro() END
2016/04/19 17:07:17  DEBUG> LogicEXTB0103.GetCashAndElectroMoney() 現金電子マネー情報取得
■SQL Data :
   Sql Command > SELECT  DISTINCT 
    t2.regi_nm, 
    t3.tenpo_nm, 
    t1.deposit_amount 
FROM  ( SELECT 
            yoyaku_no, 
            register_cd, 
            SUM(deposit_amount) deposit_amount 
        FROM  ALSOK_DEPOSIT_TBL 
        GROUP BY 
            yoyaku_no, 
            register_cd 
      ) t1 
  LEFT OUTER  JOIN  ALSOK_DEPOSIT_TBL t0 
        ON  t1.yoyaku_no   = t0.yoyaku_no 
        AND t1.register_cd = t0.register_cd 
  LEFT JOIN  ALSOK_TENPO_MST t2 
        ON  t1.register_cd = t2.regi_cd 
  LEFT JOIN  TENPO_MST t3 
        ON  t0.tenpo_cd = t3.tenpo_cd 
WHERE 
    t1.yoyaku_no = :YoyakuNo 
ORDER BY 
    t2.regi_nm
   Parameters Data > 
      [:YoyakuNo] T00118
2016/04/19 17:07:17  TRACE> LogicEXTB0103.GetCashAndElectroMoney() END
2016/04/19 17:07:17  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:07:17  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:07:17  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:07:17  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:07:17  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:07:44  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:44  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:44  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:44  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:44  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:44  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:07:44  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:07:44  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:44  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:45  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:07:45  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:07:45  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:45  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:45  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:07:45  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:07:45  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:07:45  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:07:45  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00118' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:07:45  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:07:45  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:07:50  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:50  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:50  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:50  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:50  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:50  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:07:50  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:07:50  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:07:50  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:07:50  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00099' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:07:50  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:07:50  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:07:51  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:51  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:51  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:51  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:51  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:51  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:07:51  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:07:51  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:07:51  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:07:51  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00099' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:07:51  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:07:51  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:07:53  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:07:53  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:07:53  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:53  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:07:53  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:07:53  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:07:53  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:07:53  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00099
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:07:53  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:07:53  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:07:53  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00099
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:07:53  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:07:53  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:07:53  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:07:53  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:07:53  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:08:23  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:08:23  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:08:23  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:08:23  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:08:23  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:08:23  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:08:23  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:23  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:08:23  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:08:23  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:08:23  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:08:23  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:08:23  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00099' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:08:23  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:08:23  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:08:35  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:08:35  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:08:35  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:35  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:08:35  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:08:35  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:08:35  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:08:35  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:08:35  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:08:35  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND TO_DATE(t2.YOYAKU_DT, 'YYYY/MM/DD') >= TO_DATE('2015/12/01', 'YYYY/MM/DD') 
AND TO_DATE(t2.YOYAKU_DT, 'YYYY/MM/DD') <= TO_DATE('2015/12/31', 'YYYY/MM/DD') 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:08:35  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:08:35  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:14:59  TRACE> LogicEXTA0101.GetConfigrationFlg() START
2016/04/19 17:14:59  TRACE> LogicEXTA0101.GetConfigrationFlg() END
2016/04/19 17:14:59  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:14:59  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:15:06  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:15:06  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:15:07  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:07  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:07  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:15:07  TRACE> LogicEXTA0101.LoginInputCheck() START
2016/04/19 17:15:07  TRACE> LogicEXTA0101.LoginInputCheck() END
2016/04/19 17:15:07  TRACE> LogicEXTA0101.GetLoginData() START
2016/04/19 17:15:07  TRACE> SqlEXTA0101.setSelectLoginData() START
2016/04/19 17:15:07  TRACE> SqlEXTA0101.setSelectLoginData() END
2016/04/19 17:15:07  DEBUG> LogicEXTA0101.GetLoginData() ログイン情報取得
■SQL Data :
   Sql Command > select 
USER_NM, 
MAIL, 
BUSHO_CD, 
SHONIN_FLG, 
MST_FLG 
FROM 
USER_MST 
WHERE
USER_CD = :UserId 
and PW = :Password 
and STS = '0' 
   Parameters Data > 
      [:UserId] USN001
      [:Password] password
2016/04/19 17:15:07  TRACE> LogicEXTA0101.GetLoginData() END
2016/04/19 17:15:07  TRACE> LogicEXTA0101.DelYoyakuCtlData() START
2016/04/19 17:15:07  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc1
■SQL Data :
   Sql Command > DELETE 
FROM 
YCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] USN001
2016/04/19 17:15:07  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc2
■SQL Data :
   Sql Command > DELETE 
FROM 
CCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] USN001
2016/04/19 17:15:07  TRACE> LogicEXTA0101.DelYoyakuCtlData() END
2016/04/19 17:15:07  TRACE> LogicEXTA0101.SetSystemProperties() START
2016/04/19 17:15:07  TRACE> SqlEXTA0101.setSelectSystemProperty() START
2016/04/19 17:15:07  TRACE> SqlEXTA0101.setSelectSystemProperty() END
2016/04/19 17:15:07  DEBUG> LogicEXTA0101.SetSystemProperties() システムプロパティ取得
■SQL Data :
   Sql Command > select 
TEIIN_A, 
TEIIN_B, 
KARI_JIZEN_TUTI, 
GROUP_SEIKYU 
FROM 
SYSTEM_MST 
   Parameters Data > 
2016/04/19 17:15:07  TRACE> LogicEXTA0101.SetSystemProperties() END
2016/04/19 17:15:07  TRACE> EXTA0101.btnLogin_Click() LOGIN:USN001
2016/04/19 17:15:07  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:15:07  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:15:08  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:15:08  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:15:08  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:08  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:08  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:15:09  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:15:09  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:15:30  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:15:30  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:15:30  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:30  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:30  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:15:30  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:15:30  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:15:30  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:15:30  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:15:30  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND TO_DATE(t2.YOYAKU_DT, 'YYYY/MM/DD') >= TO_DATE('2015/12/01', 'YYYY/MM/DD') 
AND TO_DATE(t2.YOYAKU_DT, 'YYYY/MM/DD') <= TO_DATE('2015/12/31', 'YYYY/MM/DD') 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:15:30  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:15:30  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:15:42  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:15:42  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:15:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:42  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:15:42  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:15:42  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:15:59  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:15:59  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:15:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:15:59  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:15:59  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:15:59  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:15:59  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:15:59  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:15:59  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
    t1.YOYAKU_NO,
    CASE t1.YOYAKU_STS
        WHEN '1' THEN '仮'
        WHEN '2' THEN '決定'
        WHEN '3' THEN '受諾'
        WHEN '4' THEN '完了'
        WHEN '5' THEN '仮予Ｃ'
        WHEN '6' THEN '正予Ｃ'
    END YOYAKU_STS,
    CASE t1.STUDIO_KBN
        WHEN '1' THEN '201st'
        WHEN '2' THEN '202st'
        WHEN '3' THEN 'house lock'
    END STUDIO,
    t2a.YOYAKU_DT_FROM,
    t2a.YOYAKU_DT_TO,
    t2b.START_TIME,
    t2c.END_TIME,
    t1.SHUTSUEN_NM,
    t1.RIYO_NM,
    t1.SEKININ_NM,
    t3.SHONIN_NINZU,
    CASE t4a.RIYO_KIN
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END RIYO_KIN,
    CASE
        WHEN t1.FINPUT_STS = '1' THEN '確定'
    END FINPUT_STS,
    CASE t4b.FUTAI_SETUBI
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END FUTAI_SETUBI,
    t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = t2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t2.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2b
 ON  t2a.YOYAKU_NO = t2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = t2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2c
 ON  t2a.YOYAKU_NO = t2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = t2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '2'AND t1.YOYAKU_NO = 'S00072' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:15:59  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:15:59  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:16:00  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:00  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:00  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetYoyakuData() START
2016/04/19 17:16:00  TRACE> SqlEXTC0102.setSelectYoyakuData() START
2016/04/19 17:16:00  TRACE> SqlEXTC0102.setSelectYoyakuData() END
2016/04/19 17:16:00  DEBUG> LogicEXTC0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] S00072
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetYoyakuData() START_2
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetYoyakuData() END_2
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetYoyakuData() END
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetRiyobiData() START
2016/04/19 17:16:00  TRACE> SqlEXTC0102.setSelectRiyobiData() START
2016/04/19 17:16:00  TRACE> SqlEXTC0102.setSelectRiyobiData() END
2016/04/19 17:16:00  DEBUG> LogicEXTC0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] S00072
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetRiyobiData() END
2016/04/19 17:16:00  TRACE> LogicEXTC0102.GetSekininshaList() START
2016/04/19 17:16:00  TRACE> SqlEXTC0102.setSelectSekininName() START
2016/04/19 17:16:00  TRACE> SqlEXTC0102.setSelectSekininName() END
2016/04/19 17:16:00  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:16:00  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:16:29  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:29  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:16:29  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:16:29  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:29  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:16:29  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:16:29  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:29  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:29  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:16:29  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:16:29  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:16:29  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:16:29  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
    t1.YOYAKU_NO,
    CASE t1.YOYAKU_STS
        WHEN '1' THEN '仮'
        WHEN '2' THEN '決定'
        WHEN '3' THEN '受諾'
        WHEN '4' THEN '完了'
        WHEN '5' THEN '仮予Ｃ'
        WHEN '6' THEN '正予Ｃ'
    END YOYAKU_STS,
    CASE t1.STUDIO_KBN
        WHEN '1' THEN '201st'
        WHEN '2' THEN '202st'
        WHEN '3' THEN 'house lock'
    END STUDIO,
    t2a.YOYAKU_DT_FROM,
    t2a.YOYAKU_DT_TO,
    t2b.START_TIME,
    t2c.END_TIME,
    t1.SHUTSUEN_NM,
    t1.RIYO_NM,
    t1.SEKININ_NM,
    t3.SHONIN_NINZU,
    CASE t4a.RIYO_KIN
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END RIYO_KIN,
    CASE
        WHEN t1.FINPUT_STS = '1' THEN '確定'
    END FINPUT_STS,
    CASE t4b.FUTAI_SETUBI
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END FUTAI_SETUBI,
    t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = t2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t2.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2b
 ON  t2a.YOYAKU_NO = t2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = t2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2c
 ON  t2a.YOYAKU_NO = t2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = t2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '2'AND t1.YOYAKU_NO = 'S00072' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:16:29  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:16:29  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:16:33  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:33  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:33  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:33  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:33  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:33  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:16:33  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:16:33  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:16:33  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:16:33  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
    t1.YOYAKU_NO,
    CASE t1.YOYAKU_STS
        WHEN '1' THEN '仮'
        WHEN '2' THEN '決定'
        WHEN '3' THEN '受諾'
        WHEN '4' THEN '完了'
        WHEN '5' THEN '仮予Ｃ'
        WHEN '6' THEN '正予Ｃ'
    END YOYAKU_STS,
    CASE t1.STUDIO_KBN
        WHEN '1' THEN '201st'
        WHEN '2' THEN '202st'
        WHEN '3' THEN 'house lock'
    END STUDIO,
    t2a.YOYAKU_DT_FROM,
    t2a.YOYAKU_DT_TO,
    t2b.START_TIME,
    t2c.END_TIME,
    t1.SHUTSUEN_NM,
    t1.RIYO_NM,
    t1.SEKININ_NM,
    t3.SHONIN_NINZU,
    CASE t4a.RIYO_KIN
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END RIYO_KIN,
    CASE
        WHEN t1.FINPUT_STS = '1' THEN '確定'
    END FINPUT_STS,
    CASE t4b.FUTAI_SETUBI
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END FUTAI_SETUBI,
    t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = t2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t2.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2b
 ON  t2a.YOYAKU_NO = t2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = t2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2c
 ON  t2a.YOYAKU_NO = t2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = t2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '2'AND t1.YOYAKU_NO = 'S00069' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:16:33  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:16:33  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:16:35  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:35  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:35  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:35  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:35  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:35  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:16:35  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:16:35  TRACE> LogicEXTC0102.GetYoyakuData() START
2016/04/19 17:16:35  TRACE> SqlEXTC0102.setSelectYoyakuData() START
2016/04/19 17:16:35  TRACE> SqlEXTC0102.setSelectYoyakuData() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] S00069
2016/04/19 17:16:35  TRACE> LogicEXTC0102.GetYoyakuData() START_2
2016/04/19 17:16:35  TRACE> LogicEXTC0102.GetYoyakuData() END_2
2016/04/19 17:16:35  TRACE> LogicEXTC0102.GetYoyakuData() END
2016/04/19 17:16:35  TRACE> LogicEXTC0102.GetRiyobiData() START
2016/04/19 17:16:35  TRACE> SqlEXTC0102.setSelectRiyobiData() START
2016/04/19 17:16:35  TRACE> SqlEXTC0102.setSelectRiyobiData() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] S00069
2016/04/19 17:16:35  TRACE> LogicEXTC0102.GetRiyobiData() END
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetApproval() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectApprovalReq() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectApprovalReq() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] S00069
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectApprovalRes() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectApprovalRes() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] S00069
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetApproval() END
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetFutai() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectFutaiHeadder() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectFutaiHeadder() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '2' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] S00069
      [:Riyobi] 2016/10/30
      [:ShisetuKbn] 2
      [:SYANAI] 2
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectFutaiDetail() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectFutaiDetail() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] S00069
      [:ShisetuKbn] 2
      [:Riyobi] 2016/10/30
      [:SYANAI] 2
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetFutai() END
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetBillReq() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectBillReq() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectBillReq() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] S00069
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetBillReq() END
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetExasRiyoryo() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectExasRiyoryo() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selecContents() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] リハスタ２０１６年１０月
      [:Riyobi] 20161028
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectExasRiyoryo() END
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectExasFutai() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectExasFutai() END
2016/04/19 17:16:35  DEBUG> LogicEXTC0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t2.kamoku_nm ASC 
   Parameters Data > 
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetExasRiyoryo() END
2016/04/19 17:16:35  TRACE> LogicEXTC0103.GetNyukin() START
2016/04/19 17:16:35  TRACE> SqlEXTC0103.selectNyukin() START
2016/04/19 17:16:36  TRACE> SqlEXTC0103.selectNyukin() END
2016/04/19 17:16:36  TRACE> SqlEXTC0103.selectNyukin() START
2016/04/19 17:16:36  TRACE> SqlEXTC0103.selectNyukin() END
2016/04/19 17:16:36  DEBUG> LogicEXTC0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND yoyaku_no = 'S00069' 
AND seikyu_irai_no = 'E00484' 
AND nyukin_link_no = (select MIN(nyukin_link_no) FROM exas_nyukin_tbl WHERE nyukin_dt = (select MIN(nyukin_dt) FROM exas_nyukin_tbl WHERE seikyu_irai_no = 'E00484') and seikyu_irai_no = 'E00484')

   Parameters Data > 
      [:LineNo] 1
2016/04/19 17:16:36  TRACE> LogicEXTC0103.GetNyukin() END
2016/04/19 17:16:36  TRACE> LogicEXTC0102.GetSekininshaList() START
2016/04/19 17:16:36  TRACE> SqlEXTC0102.setSelectSekininName() START
2016/04/19 17:16:36  TRACE> SqlEXTC0102.setSelectSekininName() END
2016/04/19 17:16:36  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:16:36  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:16:59  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:59  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:16:59  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:16:59  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:16:59  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:16:59  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:16:59  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:16:59  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:17:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:17:00  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:17:00  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:17:00  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:17:00  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:17:00  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:17:00  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
    t1.YOYAKU_NO,
    CASE t1.YOYAKU_STS
        WHEN '1' THEN '仮'
        WHEN '2' THEN '決定'
        WHEN '3' THEN '受諾'
        WHEN '4' THEN '完了'
        WHEN '5' THEN '仮予Ｃ'
        WHEN '6' THEN '正予Ｃ'
    END YOYAKU_STS,
    CASE t1.STUDIO_KBN
        WHEN '1' THEN '201st'
        WHEN '2' THEN '202st'
        WHEN '3' THEN 'house lock'
    END STUDIO,
    t2a.YOYAKU_DT_FROM,
    t2a.YOYAKU_DT_TO,
    t2b.START_TIME,
    t2c.END_TIME,
    t1.SHUTSUEN_NM,
    t1.RIYO_NM,
    t1.SEKININ_NM,
    t3.SHONIN_NINZU,
    CASE t4a.RIYO_KIN
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END RIYO_KIN,
    CASE
        WHEN t1.FINPUT_STS = '1' THEN '確定'
    END FINPUT_STS,
    CASE t4b.FUTAI_SETUBI
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END FUTAI_SETUBI,
    t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = t2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t2.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2b
 ON  t2a.YOYAKU_NO = t2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = t2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2c
 ON  t2a.YOYAKU_NO = t2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = t2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '2'AND t1.YOYAKU_NO = 'S00069' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:17:00  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:17:00  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:17:01  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:17:01  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:17:01  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:17:01  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:17:01  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:17:02  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:17:02  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:17:04  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:17:04  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:17:04  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:17:04  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:17:04  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:17:04  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:17:04  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:17:04  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:17:04  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:17:04  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
    t1.YOYAKU_NO,
    CASE t1.YOYAKU_STS
        WHEN '1' THEN '仮'
        WHEN '2' THEN '決定'
        WHEN '3' THEN '受諾'
        WHEN '4' THEN '完了'
        WHEN '5' THEN '仮予Ｃ'
        WHEN '6' THEN '正予Ｃ'
    END YOYAKU_STS,
    CASE t1.STUDIO_KBN
        WHEN '1' THEN '201st'
        WHEN '2' THEN '202st'
        WHEN '3' THEN 'house lock'
    END STUDIO,
    t2a.YOYAKU_DT_FROM,
    t2a.YOYAKU_DT_TO,
    t2b.START_TIME,
    t2c.END_TIME,
    t1.SHUTSUEN_NM,
    t1.RIYO_NM,
    t1.SEKININ_NM,
    t3.SHONIN_NINZU,
    CASE t4a.RIYO_KIN
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END RIYO_KIN,
    CASE
        WHEN t1.FINPUT_STS = '1' THEN '確定'
    END FINPUT_STS,
    CASE t4b.FUTAI_SETUBI
        WHEN '0' THEN ''
        WHEN '1' THEN '△'
        WHEN '2' THEN '〇'
        WHEN '3' THEN '◎'
    END FUTAI_SETUBI,
    t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = t2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t2.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2b
 ON  t2a.YOYAKU_NO = t2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = t2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '2'
     ) t2c
 ON  t2a.YOYAKU_NO = t2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = t2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '2' ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:17:04  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:17:04  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:18:15  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:18:15  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:18:16  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:18:16  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:18:16  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:18:16  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:18:16  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:18:48  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:18:48  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:18:49  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:18:49  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:18:49  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:18:49  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:18:49  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00026' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:18:49  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:18:49  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:18:49  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:18:49  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:18:50  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:18:50  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:18:50  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:18:50  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:18:50  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:18:50  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetApproval() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectApprovalReq() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectApprovalReq() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectApprovalRes() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectApprovalRes() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetApproval() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetTimeSchedule() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectTimeSch() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectTimeSch() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetTimeSchedule() タイムスケジュール情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    shurui, 
    time, 
    biko 
FROM 
    time_schedule_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY time 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetTimeSchedule() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetTicketInfo() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectTicket() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectTicket() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetTicketInfo() チケット情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    ticket_nm, 
    ticket_kin 
FROM 
    ticket_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetTicketInfo() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetFutai() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectFutaiHeadder() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectFutaiHeadder() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '1' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00026
      [:Riyobi] 2015/12/03
      [:ShisetuKbn] 1
      [:SYANAI] 2
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectFutaiDetail() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectFutaiDetail() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] T00026
      [:ShisetuKbn] 1
      [:Riyobi] 2015/12/03
      [:SYANAI] 2
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetFutai() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetBillReq() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectBillReq() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectBillReq() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetBillReq() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetExasRiyoryo() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectExasRiyoryo() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151203
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectExasRiyoryo() END
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectExasFutai() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151203
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151203
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectExasFutai() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t1.shukei_grp ASC 
   Parameters Data > 
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetExasRiyoryo() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetNyukin() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND yoyaku_no = 'T00026' 
AND seikyu_irai_no = '' 
AND nyukin_link_no = (select MIN(nyukin_link_no) FROM exas_nyukin_tbl WHERE nyukin_dt = (select MIN(nyukin_dt) FROM exas_nyukin_tbl WHERE seikyu_irai_no = '') and seikyu_irai_no = '')

   Parameters Data > 
      [:LineNo] 1
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetNyukin() END
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetCashAndElectroMoney() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectCashElectro() START
2016/04/19 17:18:50  TRACE> SqlEXTB0103.selectCashElectro() END
2016/04/19 17:18:50  DEBUG> LogicEXTB0103.GetCashAndElectroMoney() 現金電子マネー情報取得
■SQL Data :
   Sql Command > SELECT  DISTINCT 
    t2.regi_nm, 
    t3.tenpo_nm, 
    t1.deposit_amount 
FROM  ( SELECT 
            yoyaku_no, 
            register_cd, 
            SUM(deposit_amount) deposit_amount 
        FROM  ALSOK_DEPOSIT_TBL 
        GROUP BY 
            yoyaku_no, 
            register_cd 
      ) t1 
  LEFT OUTER  JOIN  ALSOK_DEPOSIT_TBL t0 
        ON  t1.yoyaku_no   = t0.yoyaku_no 
        AND t1.register_cd = t0.register_cd 
  LEFT JOIN  ALSOK_TENPO_MST t2 
        ON  t1.register_cd = t2.regi_cd 
  LEFT JOIN  TENPO_MST t3 
        ON  t0.tenpo_cd = t3.tenpo_cd 
WHERE 
    t1.yoyaku_no = :YoyakuNo 
ORDER BY 
    t2.regi_nm
   Parameters Data > 
      [:YoyakuNo] T00026
2016/04/19 17:18:50  TRACE> LogicEXTB0103.GetCashAndElectroMoney() END
2016/04/19 17:18:50  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:18:50  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:18:50  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:18:50  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:18:50  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:19:25  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:25  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:25  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:25  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:19:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:19:26  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:19:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:19:26  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:26  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:26  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:19:26  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:19:26  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:19:26  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:19:26  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00026' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:19:26  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:19:26  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:19:31  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:31  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:31  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:31  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:31  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:31  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:19:31  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:19:32  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:19:32  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:19:32  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00102' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:19:32  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:19:32  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:19:33  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:33  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:33  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:33  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:33  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:33  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:19:33  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:19:33  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:19:33  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:19:33  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:19:33  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetApproval() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectApprovalReq() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectApprovalReq() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectApprovalRes() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectApprovalRes() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetApproval() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTimeSchedule() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectTimeSch() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectTimeSch() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetTimeSchedule() タイムスケジュール情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    shurui, 
    time, 
    biko 
FROM 
    time_schedule_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY time 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTimeSchedule() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTicketInfo() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectTicket() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectTicket() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetTicketInfo() チケット情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    ticket_nm, 
    ticket_kin 
FROM 
    ticket_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTicketInfo() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetFutai() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectFutaiHeadder() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectFutaiHeadder() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '1' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00102
      [:Riyobi] 2015/12/02
      [:ShisetuKbn] 1
      [:SYANAI] 1
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectFutaiDetail() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectFutaiDetail() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] T00102
      [:ShisetuKbn] 1
      [:Riyobi] 2015/12/02
      [:SYANAI] 1
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetFutai() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTax() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectTax() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectTax() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTax() TAX = 0.08
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetTax() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetBillReq() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectBillReq() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectBillReq() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetBillReq() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetExasRiyoryo() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectExasRiyoryo() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectExasRiyoryo() END
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectExasFutai() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151202
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１２月
      [:Riyobi] 20151202
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectExasFutai() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t1.shukei_grp ASC 
   Parameters Data > 
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetExasRiyoryo() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetNyukin() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND nyukin_link_no = '19' 

   Parameters Data > 
      [:LineNo] 2
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetNyukin() END
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetCashAndElectroMoney() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectCashElectro() START
2016/04/19 17:19:33  TRACE> SqlEXTB0103.selectCashElectro() END
2016/04/19 17:19:33  DEBUG> LogicEXTB0103.GetCashAndElectroMoney() 現金電子マネー情報取得
■SQL Data :
   Sql Command > SELECT  DISTINCT 
    t2.regi_nm, 
    t3.tenpo_nm, 
    t1.deposit_amount 
FROM  ( SELECT 
            yoyaku_no, 
            register_cd, 
            SUM(deposit_amount) deposit_amount 
        FROM  ALSOK_DEPOSIT_TBL 
        GROUP BY 
            yoyaku_no, 
            register_cd 
      ) t1 
  LEFT OUTER  JOIN  ALSOK_DEPOSIT_TBL t0 
        ON  t1.yoyaku_no   = t0.yoyaku_no 
        AND t1.register_cd = t0.register_cd 
  LEFT JOIN  ALSOK_TENPO_MST t2 
        ON  t1.register_cd = t2.regi_cd 
  LEFT JOIN  TENPO_MST t3 
        ON  t0.tenpo_cd = t3.tenpo_cd 
WHERE 
    t1.yoyaku_no = :YoyakuNo 
ORDER BY 
    t2.regi_nm
   Parameters Data > 
      [:YoyakuNo] T00102
2016/04/19 17:19:33  TRACE> LogicEXTB0103.GetCashAndElectroMoney() END
2016/04/19 17:19:33  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:19:33  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:19:33  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:19:33  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:19:33  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:19:57  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:57  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:19:57  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:19:57  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:57  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:19:57  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:19:57  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:19:57  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:19:57  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:19:57  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:19:57  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:19:57  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:19:57  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00102' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:19:57  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:19:57  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:20:02  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:02  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:02  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:02  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:02  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:02  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:20:02  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:20:02  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:20:02  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:20:02  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00057' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:20:02  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:20:02  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:20:03  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:03  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:03  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:03  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:03  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:03  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:20:03  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:20:03  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:20:03  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:20:03  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:20:03  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetApproval() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectApprovalReq() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectApprovalReq() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectApprovalRes() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectApprovalRes() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetApproval() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetTimeSchedule() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectTimeSch() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectTimeSch() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetTimeSchedule() タイムスケジュール情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    shurui, 
    time, 
    biko 
FROM 
    time_schedule_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY time 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetTimeSchedule() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetTicketInfo() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectTicket() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectTicket() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetTicketInfo() チケット情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    ticket_nm, 
    ticket_kin 
FROM 
    ticket_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetTicketInfo() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetFutai() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectFutaiHeadder() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectFutaiHeadder() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '1' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00057
      [:Riyobi] 2015/11/29
      [:ShisetuKbn] 1
      [:SYANAI] 2
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectFutaiDetail() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectFutaiDetail() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] T00057
      [:ShisetuKbn] 1
      [:Riyobi] 2015/11/29
      [:SYANAI] 2
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetFutai() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetBillReq() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectBillReq() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectBillReq() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetBillReq() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetExasRiyoryo() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectExasRiyoryo() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１１月
      [:Riyobi] 20151127
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectExasRiyoryo() END
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectExasFutai() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１１月
      [:Riyobi] 20151127
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１１月
      [:Riyobi] 20151127
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectExasFutai() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t1.shukei_grp ASC 
   Parameters Data > 
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetExasRiyoryo() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetNyukin() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND yoyaku_no = 'T00057' 
AND seikyu_irai_no = '' 
AND nyukin_link_no = (select MIN(nyukin_link_no) FROM exas_nyukin_tbl WHERE nyukin_dt = (select MIN(nyukin_dt) FROM exas_nyukin_tbl WHERE seikyu_irai_no = '') and seikyu_irai_no = '')

   Parameters Data > 
      [:LineNo] 1
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetNyukin() END
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetCashAndElectroMoney() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectCashElectro() START
2016/04/19 17:20:03  TRACE> SqlEXTB0103.selectCashElectro() END
2016/04/19 17:20:03  DEBUG> LogicEXTB0103.GetCashAndElectroMoney() 現金電子マネー情報取得
■SQL Data :
   Sql Command > SELECT  DISTINCT 
    t2.regi_nm, 
    t3.tenpo_nm, 
    t1.deposit_amount 
FROM  ( SELECT 
            yoyaku_no, 
            register_cd, 
            SUM(deposit_amount) deposit_amount 
        FROM  ALSOK_DEPOSIT_TBL 
        GROUP BY 
            yoyaku_no, 
            register_cd 
      ) t1 
  LEFT OUTER  JOIN  ALSOK_DEPOSIT_TBL t0 
        ON  t1.yoyaku_no   = t0.yoyaku_no 
        AND t1.register_cd = t0.register_cd 
  LEFT JOIN  ALSOK_TENPO_MST t2 
        ON  t1.register_cd = t2.regi_cd 
  LEFT JOIN  TENPO_MST t3 
        ON  t0.tenpo_cd = t3.tenpo_cd 
WHERE 
    t1.yoyaku_no = :YoyakuNo 
ORDER BY 
    t2.regi_nm
   Parameters Data > 
      [:YoyakuNo] T00057
2016/04/19 17:20:03  TRACE> LogicEXTB0103.GetCashAndElectroMoney() END
2016/04/19 17:20:03  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:20:03  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:20:03  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:20:03  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:20:03  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:20:26  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:20:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:20:26  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:20:26  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:20:26  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:26  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:26  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:20:26  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:20:26  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:20:26  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:20:26  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00057' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:20:26  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:20:26  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:20:30  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:30  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:30  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:30  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:30  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:30  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:20:30  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:20:30  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:20:30  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:20:30  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00113' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:20:30  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:20:30  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:20:31  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:20:31  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:20:31  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:31  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:20:31  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:20:31  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:20:31  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:20:31  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:20:31  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:20:31  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:20:31  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:20:31  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:20:31  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:20:31  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:20:31  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetApproval() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectApprovalReq() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectApprovalReq() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetApproval() 確認依頼情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.irai_dt, 'yyyy/mm/dd hh24:mi') as irai_dt, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    irai_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.irai_usercd = t2.user_cd 
WHERE yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectApprovalRes() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectApprovalRes() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetApproval() 確認記録情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    to_char(t1.check_dt, 'yyyy/mm/dd hh24:mi') as check_dt, 
    t1.check_sts, 
    t1.com, 
    t2.user_nm as user_nm 
FROM 
    check_rireki_tbl t1 
    LEFT JOIN 
        user_mst t2 
        ON  t1.check_usercd = t2.user_cd 
WHERE t1.yoyaku_no = :YoyakuNo ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetApproval() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetTimeSchedule() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectTimeSch() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectTimeSch() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetTimeSchedule() タイムスケジュール情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    shurui, 
    time, 
    biko 
FROM 
    time_schedule_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY time 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetTimeSchedule() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetTicketInfo() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectTicket() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectTicket() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetTicketInfo() チケット情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    seq, 
    ticket_nm, 
    ticket_kin 
FROM 
    ticket_tbl 
WHERE yoyaku_no = :YoyakuNo 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetTicketInfo() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetFutai() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectFutaiHeadder() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectFutaiHeadder() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.fuzoku_nm, 
    t1.total_fuzoku_kin 
   ,CASE WHEN :SYANAI = '2' THEN 0 ELSE COALESCE(t2.tax_kin,0) END AS tax_kin
FROM 
    friyo_tbl t1 
LEFT JOIN ( SELECT t0.YOYAKU_NO , t0.YOYAKU_DT , sum(t0.tax_kin) AS tax_kin 
 FROM  ( SELECT CASE WHEN tt2.NOTAX_FLG = '0' THEN ROUND((tt1.FUTAI_KIN * tt3.TAX_RITU ) /100 ,0 )
                                              ELSE 0 
                END TAX_KIN 
               ,tt1.YOYAKU_NO 
               ,tt1.YOYAKU_DT 
         FROM  FRIYO_MEISAI_TBL tt1 
           LEFT OUTER JOIN  FBUNRUI_MST tt2 
                       ON   tt1.FUTAI_BUNRUI_CD = tt2.BUNRUI_CD 
                      AND   '1' = tt2.SHISETU_KBN 
                      AND   tt1.YOYAKU_DT BETWEEN tt2.KIKAN_FROM AND tt2.KIKAN_TO 
           LEFT OUTER JOIN  TAX_MST tt3 
                       ON   tt1.YOYAKU_DT BETWEEN tt3.TAXS_DT AND tt3.TAXE_DT 
        ) t0 
 GROUP BY t0.YOYAKU_NO , t0.YOYAKU_DT 
       ) t2 
      ON  t1.YOYAKU_NO = t2.YOYAKU_NO 
     AND  t1.YOYAKU_DT = t2.YOYAKU_DT 
WHERE t1.yoyaku_no = :YoyakuNo 
 AND  t1.yoyaku_dt = :Riyobi 
ORDER BY add_dt 
   Parameters Data > 
      [:YoyakuNo] T00113
      [:Riyobi] 2015/11/24
      [:ShisetuKbn] 1
      [:SYANAI] 2
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectFutaiDetail() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectFutaiDetail() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetFutai() 付帯情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.yoyaku_dt, 
    t1.futai_bunrui_cd, 
    t1.futai_cd, 
    t1.futai_tanka, 
    t1.futai_su, 
    t1.futai_shokei, 
    t1.futai_chosei, 
    t1.futai_kin, 
    t1.futai_biko, 
    m1.futai_nm, 
    m1.tani as futai_tani, 
    m2.bunrui_nm as futai_bunrui_nm, 
    m2.shukei_grp, 
    m2.kamoku_cd, 
    m2.saimoku_cd, 
    m2.uchi_cd, 
    m2.shosai_cd, 
    m2.karikamoku_cd, 
    m2.kari_saimoku_cd, 
    m2.kari_uchi_cd, 
    m2.kari_shosai_cd, 
    m2.notax_flg, 
    m3.kamoku_nm, 
    m3.saimoku_nm, 
    m3.uchi_nm, 
    m3.shosai_nm 
   ,COALESCE((CASE WHEN :SYANAI = '2' THEN  0
                            ELSE 
                               CASE WHEN m2.notax_flg = '0' THEN ROUND((t1.futai_kin * m4.tax_ritu) /100 ,0)
                                    ELSE 0 
                               END 
     END),0)  as tax_kin 
FROM 
    friyo_meisai_tbl t1 
LEFT JOIN futai_mst m1 
    ON t1.futai_bunrui_cd = m1.bunrui_cd 
    AND t1.futai_cd = m1.futai_cd 
    AND m1.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m1.kikan_from AND m1.kikan_to 
    AND m1.sts = '0' 
LEFT JOIN fbunrui_mst m2 
    ON t1.futai_bunrui_cd = m2.bunrui_cd 
    AND m2.shisetu_kbn = :ShisetuKbn 
    AND :Riyobi BETWEEN m2.kikan_from AND m2.kikan_to 
    AND m2.sts = '0' 
LEFT JOIN kamoku_mst m3 
    ON m2.kamoku_cd = m3.kamoku_cd 
    AND m2.saimoku_cd = m3.saimoku_cd 
    AND m2.uchi_cd = m3.uchi_cd 
    AND m2.shosai_cd = m3.shosai_cd 
    AND m3.sts = '0' 
LEFT JOIN TAX_MST m4 
    ON  :Riyobi BETWEEN m4.TAXS_DT AND m4.TAXE_DT
WHERE 
    t1.yoyaku_no = :YoyakuNo 
    AND t1.yoyaku_dt = :Riyobi 
ORDER BY t1.add_dt 
   Parameters Data > 
      [:YoyakuNo] T00113
      [:ShisetuKbn] 1
      [:Riyobi] 2015/11/24
      [:SYANAI] 2
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetFutai() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetBillReq() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectBillReq() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectBillReq() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetBillReq() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_dt, 
    t1.nyukin_yotei_dt, 
    t1.kakutei_kin, 
    t1.chosei_kin, 
    t1.shokei, 
    t1.tax_kin, 
    t1.seikyu_kin, 
    t1.seikyu_naiyo, 
    CASE WHEN t1.seikyu_naiyo='1' THEN '利用料' WHEN t1.seikyu_naiyo='2' THEN '付帯設備'
         WHEN t1.seikyu_naiyo='3' THEN '利用料+付帯設備' WHEN t1.seikyu_naiyo='4' THEN '還付' ELSE '' END as seikyu_naiyo_nm, 
    t1.aite_cd, 
    m1.aite_nm, 
    t1.nyukin_kbn, 
    t1.seikyu_title1, 
    t1.seikyu_title2, 
    t1.nyukin_dt, 
    t1.nyukin_kin, 
    t1.seikyu_input_flg, 
    t1.seikyu_irai_flg, 
    t1.nyukin_input_flg, 
    t1.nyukin_link_no,
    t1.seikyu_input_flg AS get_seikyu_input_flg 
FROM 
    BILLPAY_TBL t1 
LEFT JOIN AITESAKI_MST m1 
    ON t1.aite_cd = m1.aite_cd 
WHERE t1.yoyaku_no = :YoyakuNo 
ORDER BY t1.seq 
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetBillReq() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetExasRiyoryo() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectExasRiyoryo() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１１月
      [:Riyobi] 20151123
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectExasRiyoryo() END
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectExasFutai() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１１月
      [:Riyobi] 20151123
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selecContents() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selecContents() END
■SQL Data :
   Sql Command > SELECT 
    m1.event_cd, 
    m1.event_nm, 
    m2.content_uchi_cd, 
    m2.content_uchi_nm 
FROM CONTENT_MST m1 
LEFT JOIN CONTENT_UCHI_MST m2 
    ON m1.event_cd = m2.content_cd 
WHERE (m1.del_flg <> '1' OR m1.del_flg is null ) 
    AND (m2.del_flg <> '1' OR m2.del_flg is null ) 
    AND :Riyobi BETWEEN m1.strat_dt AND m1.end_dt 
    AND :ContentUchiNm = m2.content_uchi_nm 
   Parameters Data > 
      [:ContentUchiNm] 貸館２０１５年１１月
      [:Riyobi] 20151123
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectExasFutai() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetExasRiyoryo() EXASプロジェクト情報取得
■SQL Data :
   Sql Command > SELECT 
    t1.yoyaku_no, 
    t1.seq, 
    t1.seikyu_irai_no, 
    t1.seikyu_irai_seq, 
    t1.seikyu_naiyo, 
    t1.riyo_ym, 
    t1.shukei_grp, 
    t2.kamoku_nm, 
    t2.saimoku_nm, 
    t2.uchi_nm, 
    t2.shosai_nm, 
    t1.keijo_kin, 
    COALESCE(t1.tax_kin,0) tax_kin ,
    t1.tekiyo1, 
    t1.tekiyo2, 
    t3.event_nm, 
    t4.content_uchi_nm, 
    t1.kamoku_cd, 
    t1.saimoku_cd, 
    t1.uchi_cd, 
    t1.shosai_cd, 
    t1.content_cd, 
    t1.content_uchi_cd, 
    t1.shukei_grp, 
    t2.karikamoku_cd, 
    t2.kari_saimoku_cd, 
    t2.kari_uchi_cd, 
    t2.kari_shosai_cd 
FROM 
    project_tbl t1 
    LEFT JOIN 
        kamoku_mst t2 
    ON  t1.kamoku_cd = t2.kamoku_cd 
    AND t1.saimoku_cd = t2.saimoku_cd 
    AND t1.uchi_cd = t2.uchi_cd 
    AND t1.shosai_cd = t2.shosai_cd 
    LEFT JOIN 
        content_mst t3 
    ON  t1.content_cd = t3.event_cd 
    LEFT JOIN 
        content_uchi_mst t4 
    ON  t1.content_cd = t4.content_cd 
    AND t1.content_uchi_cd = t4.content_uchi_cd 
WHERE 
    ( 
        t1.seikyu_naiyo = '2' 
    OR  t1.seikyu_naiyo = '3' 
    ) 
AND t1.yoyaku_no = :YoyakuNo 
AND t1.seikyu_irai_no = :SeikyuIraiNo 
 ORDER BY 
   t1.riyo_ym ASC , t1.shukei_grp ASC 
   Parameters Data > 
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetExasRiyoryo() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetNyukin() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectNyukin() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectNyukin() END
2016/04/19 17:20:31  DEBUG> LogicEXTB0103.GetNyukin() 請求情報取得
■SQL Data :
   Sql Command > SELECT 
    yoyaku_no, 
    aite_cd, 
    aite_nm, 
    nyukin_yotei_dt, 
    nyukin_dt, 
    seikyu_kin, 
    seikyu_dt, 
    input_dt, 
    sekikyu_no, 
    seikyu_irai_no, 
    seikyu_kin, 
    nyukin_link_no, 
    :LineNo as line_no 
FROM 
    exas_nyukin_tbl 
WHERE 1 = 1 AND yoyaku_no = 'T00113' 
AND seikyu_irai_no = '' 
AND nyukin_link_no = (select MIN(nyukin_link_no) FROM exas_nyukin_tbl WHERE nyukin_dt = (select MIN(nyukin_dt) FROM exas_nyukin_tbl WHERE seikyu_irai_no = '') and seikyu_irai_no = '')

   Parameters Data > 
      [:LineNo] 1
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetNyukin() END
2016/04/19 17:20:31  TRACE> LogicEXTB0103.GetCashAndElectroMoney() START
2016/04/19 17:20:31  TRACE> SqlEXTB0103.selectCashElectro() START
2016/04/19 17:20:32  TRACE> SqlEXTB0103.selectCashElectro() END
2016/04/19 17:20:32  DEBUG> LogicEXTB0103.GetCashAndElectroMoney() 現金電子マネー情報取得
■SQL Data :
   Sql Command > SELECT  DISTINCT 
    t2.regi_nm, 
    t3.tenpo_nm, 
    t1.deposit_amount 
FROM  ( SELECT 
            yoyaku_no, 
            register_cd, 
            SUM(deposit_amount) deposit_amount 
        FROM  ALSOK_DEPOSIT_TBL 
        GROUP BY 
            yoyaku_no, 
            register_cd 
      ) t1 
  LEFT OUTER  JOIN  ALSOK_DEPOSIT_TBL t0 
        ON  t1.yoyaku_no   = t0.yoyaku_no 
        AND t1.register_cd = t0.register_cd 
  LEFT JOIN  ALSOK_TENPO_MST t2 
        ON  t1.register_cd = t2.regi_cd 
  LEFT JOIN  TENPO_MST t3 
        ON  t0.tenpo_cd = t3.tenpo_cd 
WHERE 
    t1.yoyaku_no = :YoyakuNo 
ORDER BY 
    t2.regi_nm
   Parameters Data > 
      [:YoyakuNo] T00113
2016/04/19 17:20:32  TRACE> LogicEXTB0103.GetCashAndElectroMoney() END
2016/04/19 17:20:32  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:20:32  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:20:32  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:20:32  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:20:32  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:21:00  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:00  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:21:00  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:21:00  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:00  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:21:00  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:21:00  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:00  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:00  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:21:00  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:21:00  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:21:00  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:21:00  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00113' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:21:00  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:21:00  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:21:04  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:04  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:05  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:05  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:05  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:05  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:21:05  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:21:05  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:21:05  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:21:05  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00009' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:21:05  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:21:05  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:21:06  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:06  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:06  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:06  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:06  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetYoyakuData() START
2016/04/19 17:21:06  TRACE> SqlEXTB0102.setSelectYoyakuData() START
2016/04/19 17:21:06  TRACE> SqlEXTB0102.setSelectYoyakuData() END
2016/04/19 17:21:06  DEBUG> LogicEXTB0102.GetYoyakuData() 予約情報取得
■SQL Data :
   Sql Command > select 
t1.yoyaku_no, 
t1.kariuke_dt, 
t1.kari_usercd, 
t1.kakutei_dt, 
t1.kaku_usercd, 
t1.yoyaku_sts, 
t1.shisetu_kbn, 
t1.studio_kbn, 
t1.saiji_nm, 
t1.shutsuen_nm, 
t1.kashi_kind, 
t1.riyo_type, 
t1.drink_flg, 
t1.saiji_bunrui, 
t1.teiin, 
t1.onkyo_ope_flg, 
t1.riyosha_cd, 
t1.riyo_nm, 
t1.riyo_kana, 
t1.sekinin_busho_nm, 
t1.sekinin_nm, 
t1.sekinin_mail, 
t1.daihyo_nm, 
t1.riyo_tel11, 
t1.riyo_tel12, 
t1.riyo_tel13, 
t1.riyo_tel21, 
t1.riyo_tel22, 
t1.riyo_tel23, 
t1.riyo_naisen, 
t1.riyo_fax11, 
t1.riyo_fax12, 
t1.riyo_fax13, 
t1.riyo_yubin1, 
t1.riyo_yubin2, 
t1.riyo_todo, 
t1.riyo_shiku, 
t1.riyo_ban, 
t1.riyo_build, 
t1.riyo_lvl, 
t1.aite_cd, 
t1.onkyo_nm, 
t1.onkyo_tanto_nm, 
t1.onkyo_tel11, 
t1.onkyo_tel12, 
t1.onkyo_tel13, 
t1.onkyo_naisen, 
t1.onkyo_fax11, 
t1.onkyo_fax12, 
t1.onkyo_fax13, 
t1.onkyo_mail, 
t1.total_riyo_kin, 
t1.send_kbn, 
t1.send_sts, 
t1.send_dt, 
t1.henso_dt, 
t1.biko, 
t1.riyo_com, 
t1.ticket_enter_kbn, 
t1.ticket_drink_kbn, 
t1.hp_keisai, 
t1.joho_kokai_dt, 
t1.joho_kokai_time, 
t1.kokai_dt, 
t1.kokai_time, 
t1.finput_sts, 
to_char(t1.add_dt,'YYYY/MM/DD HH:mm') as add_dt, 
t1.add_user_cd, 
m1.user_nm as add_user_nm,
to_char(t1.up_dt,'YYYY/MM/DD HH:mm') as up_dt, 
t1.up_user_cd, 
m2.user_nm as up_user_nm, 
m3.aite_nm as aite_nm 
FROM 
YOYAKU_TBL t1
LEFT JOIN USER_MST m1
ON t1.add_user_cd = m1.user_cd
LEFT JOIN USER_MST m2
ON t1.up_user_cd = m2.user_cd
LEFT JOIN AITESAKI_MST m3
ON t1.aite_cd = m3.aite_cd
WHERE
YOYAKU_NO = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00009
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetYoyakuData() START_2
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetYoyakuData() END_2
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetYoyakuData() END
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetRiyobiData() START
2016/04/19 17:21:06  TRACE> SqlEXTB0102.setSelectRiyobiData() START
2016/04/19 17:21:06  TRACE> SqlEXTB0102.setSelectRiyobiData() END
2016/04/19 17:21:06  DEBUG> LogicEXTB0102.GetRiyobiData() 予約日時情報取得
■SQL Data :
   Sql Command > select 
seq, 
shisetu_kbn, 
studio_kbn, 
yoyaku_dt, 
start_time, 
end_time, 
yoyaku_no, 
riyo_keitai, 
mitei_flg, 
tanka, 
bairitu, 
su, 
riyo_kin 
FROM 
YDT_TBL 
WHERE
yoyaku_no = :YoyakuNo 
   Parameters Data > 
      [:YoyakuNo] T00009
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetRiyobiData() END
2016/04/19 17:21:06  TRACE> LogicEXTB0102.GetSekininshaList() START
2016/04/19 17:21:06  TRACE> SqlEXTB0102.setSelectSekininName() START
2016/04/19 17:21:06  TRACE> SqlEXTB0102.setSelectSekininName() END
2016/04/19 17:21:06  TRACE> CommonLogicEXT.SetFormBackColor() START
2016/04/19 17:21:06  TRACE> CommonLogicEXT.SetFormBackColor() END
2016/04/19 17:21:42  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:42  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:21:42  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:21:42  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:42  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() START
2016/04/19 17:21:42  TRACE> LogicEXTZ0202.DeleteYoyakuCtlShisetuData() END
2016/04/19 17:21:42  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:42  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:42  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:21:42  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:21:42  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:21:42  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:21:42  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1'AND t1.YOYAKU_NO = 'T00009' 
 ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:21:42  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:21:42  TRACE> LogicEXTZ0101.MakeSpread() END
2016/04/19 17:21:47  TRACE> CommonLogicEXT.CheckDBCondition() START
2016/04/19 17:21:47  TRACE> CommonLogicEXT.NetUseConect() START
2016/04/19 17:21:47  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:47  TRACE> CommonLogicEXT.NetUseConectDel() START
2016/04/19 17:21:47  TRACE> CommonLogicEXT.CheckDBCondition() END
2016/04/19 17:21:47  TRACE> LogicEXTZ0101.MakeSpread() START
2016/04/19 17:21:47  TRACE> LogicEXTZ0101.GetSpreadData() START
2016/04/19 17:21:47  TRACE> SqlEXTZ0101.setSelectYoyaku() START
2016/04/19 17:21:47  TRACE> SqlEXTZ0101.setSelectYoyaku() END
2016/04/19 17:21:47  DEBUG> LogicEXTZ0101.GetSpreadData() 
■SQL Data :
   Sql Command > SELECT
DISTINCT
t1.YOYAKU_NO,
CASE t1.YOYAKU_STS
    WHEN '1' THEN '仮'
    WHEN '2' THEN '決定'
    WHEN '3' THEN '受諾'
    WHEN '4' THEN '完了'
    WHEN '5' THEN '仮予Ｃ'
    WHEN '6' THEN '正予Ｃ'
END YOYAKU_STS,
t2a.YOYAKU_DT_FROM,
t2a.YOYAKU_DT_TO,
t2b.START_TIME,
t2c.END_TIME,
t1.SAIJI_NM,
CASE t1.RIYO_TYPE
    WHEN '0' THEN '未定'
    WHEN '1' THEN '着席'
    WHEN '2' THEN 'スタンディング'
    WHEN '3' THEN '変則'
    WHEN '4' THEN '催事'
END RIYO_TYPE,
t1.RIYO_NM,
t1.SEKININ_NM,
t3.SHONIN_NINZU,
CASE t4a.RIYO_KIN
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END RIYO_KIN,
CASE
    WHEN t1.FINPUT_STS = '1' THEN '確定'
END FINPUT_STS,
CASE t4b.FUTAI_SETUBI
    WHEN '0' THEN ''
    WHEN '1' THEN '△'
    WHEN '2' THEN '〇'
    WHEN '3' THEN '◎'
END FUTAI_SETUBI,
t1.YOYAKU_STS AS STS_CD
FROM
 YOYAKU_TBL t1
 LEFT JOIN YDT_TBL t2
 ON  t1.YOYAKU_NO = T2.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(YOYAKU_DT) AS YOYAKU_DT_FROM,
             MAX(YOYAKU_DT) AS YOYAKU_DT_TO
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
         GROUP BY YOYAKU_NO
     ) t2a
 ON  t1.YOYAKU_NO = T2a.YOYAKU_NO
 LEFT JOIN
     (   SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             START_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2b
 ON  t2a.YOYAKU_NO = T2b.YOYAKU_NO
 AND t2a.YOYAKU_DT_FROM = T2b.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             YOYAKU_DT,
             END_TIME
         FROM
             YDT_TBL
         WHERE
             SHISETU_KBN = '1'
     ) t2c
 ON  t2a.YOYAKU_NO = T2c.YOYAKU_NO
 AND t2a.YOYAKU_DT_TO = T2c.YOYAKU_DT
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             COUNT(YOYAKU_NO) AS SHONIN_NINZU
         FROM
             CHECK_RIREKI_TBL
         WHERE
             CHECK_STS = '1'
         GROUP BY
             YOYAKU_NO
     ) t3
 ON  t1.YOYAKU_NO = T3.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.RIYO_KIN) RIYO_KIN
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END RIYO_KIN
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '1'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4a
 ON  t1.YOYAKU_NO = t4a.YOYAKU_NO
 LEFT JOIN
     (
         SELECT
             YOYAKU_NO,
             MIN(tmp.FUTAI_SETUBI) FUTAI_SETUBI
         FROM
             (
                 SELECT
                     YOYAKU_NO,
                     CASE
                         WHEN SEIKYU_INPUT_FLG = '0' THEN '0'
                         ELSE CASE
                             WHEN SEIKYU_IRAI_FLG = '0' THEN '1'
                             ELSE CASE
                                 WHEN NYUKIN_INPUT_FLG = '0' THEN '2'
                                 ELSE '3'
                             END
                         END
                     END FUTAI_SETUBI
                 FROM
                     BILLPAY_TBL
                 WHERE
                     SEIKYU_NAIYO = '2'
                 OR  SEIKYU_NAIYO = '3'
             )tmp
        GROUP BY YOYAKU_NO
     ) t4b
 ON t1.YOYAKU_NO = t4b.YOYAKU_NO
WHERE
    t1.SHISETU_KBN = '1' ORDER BY YOYAKU_DT_FROM DESC ,  YOYAKU_NO 
   Parameters Data > 
2016/04/19 17:21:47  TRACE> LogicEXTZ0101.GetSpreadData() END
2016/04/19 17:21:47  TRACE> LogicEXTZ0101.MakeSpread() END
