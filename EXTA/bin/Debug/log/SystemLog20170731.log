2017/07/31 17:13:31  TRACE> LogicEXTA0101.GetConfigrationFlg() START
2017/07/31 17:13:31  TRACE> LogicEXTA0101.GetConfigrationFlg() END
2017/07/31 17:13:31  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:13:31  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:13:38  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:13:38  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:13:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:13:42  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:13:42  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:13:42  TRACE> LogicEXTA0101.LoginInputCheck() START
2017/07/31 17:13:42  TRACE> LogicEXTA0101.LoginInputCheck() END
2017/07/31 17:13:42  TRACE> LogicEXTA0101.GetLoginData() START
2017/07/31 17:13:42  TRACE> SqlEXTA0101.setSelectLoginData() START
2017/07/31 17:13:42  TRACE> SqlEXTA0101.setSelectLoginData() END
2017/07/31 17:13:42  DEBUG> LogicEXTA0101.GetLoginData() ログイン情報取得
■SQL Data :
   Sql Command > select 
USER_NM, 
MAIL, 
BUSHO_CD, 
SHONIN_FLG, 
MST_FLG 
FROM 
USER_MST 
WHERE
USER_CD = :UserId 
and PW = :Password 
and STS = '0' 
   Parameters Data > 
      [:UserId] admin
      [:Password] admin
2017/07/31 17:14:14  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:14:14  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:14:15  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:14:16  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:14:16  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:14:16  TRACE> LogicEXTA0101.LoginInputCheck() START
2017/07/31 17:14:16  TRACE> LogicEXTA0101.LoginInputCheck() END
2017/07/31 17:14:16  TRACE> LogicEXTA0101.GetLoginData() START
2017/07/31 17:14:16  TRACE> SqlEXTA0101.setSelectLoginData() START
2017/07/31 17:14:16  TRACE> SqlEXTA0101.setSelectLoginData() END
2017/07/31 17:14:16  DEBUG> LogicEXTA0101.GetLoginData() ログイン情報取得
■SQL Data :
   Sql Command > select 
USER_NM, 
MAIL, 
BUSHO_CD, 
SHONIN_FLG, 
MST_FLG 
FROM 
USER_MST 
WHERE
USER_CD = :UserId 
and PW = :Password 
and STS = '0' 
   Parameters Data > 
      [:UserId] 000000
      [:Password] system
2017/07/31 17:14:16  TRACE> LogicEXTA0101.GetLoginData() END
2017/07/31 17:14:16  TRACE> LogicEXTA0101.DelYoyakuCtlData() START
2017/07/31 17:14:16  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc1
■SQL Data :
   Sql Command > DELETE 
FROM 
YCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] 000000
2017/07/31 17:14:16  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc2
■SQL Data :
   Sql Command > DELETE 
FROM 
CCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] 000000
2017/07/31 17:14:16  TRACE> LogicEXTA0101.DelYoyakuCtlData() END
2017/07/31 17:14:16  TRACE> LogicEXTA0101.SetSystemProperties() START
2017/07/31 17:14:16  TRACE> SqlEXTA0101.setSelectSystemProperty() START
2017/07/31 17:14:16  TRACE> SqlEXTA0101.setSelectSystemProperty() END
2017/07/31 17:14:16  DEBUG> LogicEXTA0101.SetSystemProperties() システムプロパティ取得
■SQL Data :
   Sql Command > select 
TEIIN_A, 
TEIIN_B, 
KARI_JIZEN_TUTI, 
GROUP_SEIKYU, 
DAIKO_TANTO_CD, 
DAIKO_BUSHO_CD 
FROM 
SYSTEM_MST 
   Parameters Data > 
2017/07/31 17:14:16  TRACE> LogicEXTA0101.SetSystemProperties() END
2017/07/31 17:14:16  TRACE> EXTA0101.btnLogin_Click() LOGIN:000000
2017/07/31 17:14:16  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:14:16  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:14:18  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:14:18  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:14:18  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:14:19  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:14:19  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:14:27  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:14:27  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:14:45  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:14:45  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:14:47  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:14:47  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:14:47  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:15:04  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:15:04  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:15:06  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:06  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:06  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:15:06  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:15:06  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 01
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 02
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 03
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 04
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 05
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 06
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 07
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:06  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:06  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 08
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:07  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 09
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:07  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 10
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:07  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 11
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:07  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:07  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 12
2017/07/31 17:15:07  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:15:07  TRACE> LogicEXTZ0104.MakeSpread() END
2017/07/31 17:15:15  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:15:15  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:15:16  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:16  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:16  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:15:16  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:15:16  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:16  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 01
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:16  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 02
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:16  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 03
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:16  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 04
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:16  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 05
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:16  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 06
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 07
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 08
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 09
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 10
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 11
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:17  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:17  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 12
2017/07/31 17:15:17  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:15:17  TRACE> LogicEXTZ0104.MakeSpread() END
2017/07/31 17:15:20  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:15:20  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:15:20  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:20  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:20  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:15:20  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:15:20  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:15:20  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:20  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:20  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 01
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 02
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 03
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 04
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 05
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 06
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 07
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 08
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 09
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 10
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 11
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:21  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:21  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2013
      [:HYOJI_TSUKI] 12
2017/07/31 17:15:21  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:15:21  TRACE> LogicEXTZ0104.MakeSpread() END
2017/07/31 17:15:29  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:15:29  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:15:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:29  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:29  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:15:29  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:15:29  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:15:29  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:29  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:29  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 01
2017/07/31 17:15:30  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:30  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:30  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 02
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:31  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 03
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:31  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 04
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:31  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 05
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:31  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 06
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 07
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 08
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 09
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 10
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 11
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:32  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:32  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_201st,
        t4b.COUNT AS RIYO_NISSU_202st,
        t4c.COUNT AS RIYO_NISSU_houselock
    FROM
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
        SELECT
          COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
            (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '2'            
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4a1
                    LEFT JOIN
                        YDT_TBL t4a2
                    ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
                WHERE
                    t4a1.YOYAKU_STS = '4'
                AND t4a1.SHISETU_KBN = '2'
                AND t4a1.STUDIO_KBN = '1'
                AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4a2.YOYAKU_DT
           ) TMP
         ) t4a
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '2'
                AND t4b1.STUDIO_KBN = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
         ) t4b
    CROSS JOIN
            (
            SELECT
              COUNT(TMP.YOYAKU_DT) AS COUNT
               FROM
                (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '2'
                AND t4c1.STUDIO_KBN = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 12
2017/07/31 17:15:32  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:15:32  TRACE> LogicEXTZ0104.MakeSpread() END
2017/07/31 17:15:35  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:15:35  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:15:36  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:36  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:15:36  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:15:36  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:15:36  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:36  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 01
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:36  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 02
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:36  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 03
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:36  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 04
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:36  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 05
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 06
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 07
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 08
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 09
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 10
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 11
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:15:37  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:15:37  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 12
2017/07/31 17:15:37  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:15:37  TRACE> LogicEXTZ0104.MakeSpread() END
2017/07/31 17:22:59  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:22:59  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:23:01  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:23:01  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:23:01  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:23:02  TRACE> LogicEXTM0101.InitForm() START
2017/07/31 17:23:02  TRACE> LogicEXTM0101.InitForm() END
2017/07/31 17:23:02  TRACE> LogicEXTM0101.GetComboBusho() START
2017/07/31 17:23:02  TRACE> SqlEXTM0101.SetSelectBushoSql() START
2017/07/31 17:23:02  TRACE> SqlEXTM0101.SetSelectBushoSql() END
2017/07/31 17:23:02  DEBUG> LogicEXTM0101.GetComboBusho() 初期表示時コンボボックス取得
■SQL Data :
   Sql Command >  SELECT 
 BUSHO_CD 
,BUSHO_NM 
 FROM 
 BUSHO_MST 
 ORDER BY BUSHO_CD 
   Parameters Data > 
2017/07/31 17:23:02  TRACE> LogicEXTM0101.GetComboBusho() END
2017/07/31 17:23:02  TRACE> LogicEXTM0101.ComboBushoSet() START
2017/07/31 17:23:02  TRACE> LogicEXTM0101.ComboBushoSet() END
2017/07/31 17:23:02  TRACE> LogicEXTM0101.InitSearch() START
2017/07/31 17:23:02  TRACE> SqlEXTM0101.SetSelectInitEXTUserSearchSql() START
2017/07/31 17:23:02  TRACE> SqlEXTM0101.SetSelectInitEXTUserSearchSql() END
2017/07/31 17:23:02  DEBUG> LogicEXTM0101.InitSearch() EXシアターユーザー初期表示時検索
■SQL Data :
   Sql Command >  SELECT 
 FALSE as CHANGEKBN 
,t1.USER_CD 
,t1.PW 
,t1.USER_NM 
,t1.MAIL 
,t2.BUSHO_CD 
,CASE WHEN t1.SHONIN_FLG = '1'
 THEN TRUE 
 ELSE FALSE 
 END as SHONIN_FLG 
,CASE WHEN t1.MST_FLG = '1' 
 THEN TRUE 
 ELSE FALSE 
 END as MST_FLG 
,CASE WHEN t1.STS = '1' 
 THEN TRUE 
 ELSE FALSE 
 END as STS 
 ,t1.ADD_DT 
 ,t1.UP_DT 
 ,'1' 
 FROM USER_MST t1 
 LEFT JOIN BUSHO_MST t2
 ON t1.BUSHO_CD = t2.BUSHO_CD 
 WHERE t1.USER_CD <> '000000'  ORDER BY USER_CD 
   Parameters Data > 
2017/07/31 17:23:02  TRACE> LogicEXTM0101.InitSearch() END
2017/07/31 17:23:02  TRACE> LogicEXTM0101.SetSheet() START
2017/07/31 17:23:02  TRACE> LogicEXTM0101.CreateBushoCmbBox() START
2017/07/31 17:23:02  TRACE> LogicEXTM0101.CreateBushoCmbBox() END
2017/07/31 17:23:03  TRACE> LogicEXTM0101.SetSheet() END
2017/07/31 17:23:03  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:23:03  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:23:15  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:23:15  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:23:17  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:23:17  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:23:17  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:23:17  TRACE> LogicEXTM0101.InitForm() START
2017/07/31 17:23:17  TRACE> LogicEXTM0101.InitForm() END
2017/07/31 17:23:17  TRACE> LogicEXTM0101.GetComboBusho() START
2017/07/31 17:23:17  TRACE> SqlEXTM0101.SetSelectBushoSql() START
2017/07/31 17:23:17  TRACE> SqlEXTM0101.SetSelectBushoSql() END
2017/07/31 17:23:17  DEBUG> LogicEXTM0101.GetComboBusho() 初期表示時コンボボックス取得
■SQL Data :
   Sql Command >  SELECT 
 BUSHO_CD 
,BUSHO_NM 
 FROM 
 BUSHO_MST 
 ORDER BY BUSHO_CD 
   Parameters Data > 
2017/07/31 17:23:17  TRACE> LogicEXTM0101.GetComboBusho() END
2017/07/31 17:23:17  TRACE> LogicEXTM0101.ComboBushoSet() START
2017/07/31 17:23:17  TRACE> LogicEXTM0101.ComboBushoSet() END
2017/07/31 17:23:17  TRACE> LogicEXTM0101.InitSearch() START
2017/07/31 17:23:17  TRACE> SqlEXTM0101.SetSelectInitEXTUserSearchSql() START
2017/07/31 17:23:17  TRACE> SqlEXTM0101.SetSelectInitEXTUserSearchSql() END
2017/07/31 17:23:17  DEBUG> LogicEXTM0101.InitSearch() EXシアターユーザー初期表示時検索
■SQL Data :
   Sql Command >  SELECT 
 FALSE as CHANGEKBN 
,t1.USER_CD 
,t1.PW 
,t1.USER_NM 
,t1.MAIL 
,t2.BUSHO_CD 
,CASE WHEN t1.SHONIN_FLG = '1'
 THEN TRUE 
 ELSE FALSE 
 END as SHONIN_FLG 
,CASE WHEN t1.MST_FLG = '1' 
 THEN TRUE 
 ELSE FALSE 
 END as MST_FLG 
,CASE WHEN t1.STS = '1' 
 THEN TRUE 
 ELSE FALSE 
 END as STS 
 ,t1.ADD_DT 
 ,t1.UP_DT 
 ,'1' 
 FROM USER_MST t1 
 LEFT JOIN BUSHO_MST t2
 ON t1.BUSHO_CD = t2.BUSHO_CD 
 WHERE t1.USER_CD <> '000000'  ORDER BY USER_CD 
   Parameters Data > 
2017/07/31 17:23:17  TRACE> LogicEXTM0101.InitSearch() END
2017/07/31 17:23:17  TRACE> LogicEXTM0101.SetSheet() START
2017/07/31 17:23:17  TRACE> LogicEXTM0101.CreateBushoCmbBox() START
2017/07/31 17:23:17  TRACE> LogicEXTM0101.CreateBushoCmbBox() END
2017/07/31 17:23:17  TRACE> LogicEXTM0101.SetSheet() END
2017/07/31 17:23:17  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:23:17  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:40:14  TRACE> LogicEXTA0101.GetConfigrationFlg() START
2017/07/31 17:40:14  TRACE> LogicEXTA0101.GetConfigrationFlg() END
2017/07/31 17:40:14  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:40:14  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:40:20  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:40:20  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:40:21  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:40:21  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:40:22  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:40:22  TRACE> LogicEXTA0101.LoginInputCheck() START
2017/07/31 17:40:22  TRACE> LogicEXTA0101.LoginInputCheck() END
2017/07/31 17:40:22  TRACE> LogicEXTA0101.GetLoginData() START
2017/07/31 17:40:22  TRACE> SqlEXTA0101.setSelectLoginData() START
2017/07/31 17:40:22  TRACE> SqlEXTA0101.setSelectLoginData() END
2017/07/31 17:40:22  DEBUG> LogicEXTA0101.GetLoginData() ログイン情報取得
■SQL Data :
   Sql Command > select 
USER_NM, 
MAIL, 
BUSHO_CD, 
SHONIN_FLG, 
MST_FLG 
FROM 
USER_MST 
WHERE
USER_CD = :UserId 
and PW = :Password 
and STS = '0' 
   Parameters Data > 
      [:UserId] 000000
      [:Password] system
2017/07/31 17:40:22  TRACE> LogicEXTA0101.GetLoginData() END
2017/07/31 17:40:22  TRACE> LogicEXTA0101.DelYoyakuCtlData() START
2017/07/31 17:40:22  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc1
■SQL Data :
   Sql Command > DELETE 
FROM 
YCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] 000000
2017/07/31 17:40:22  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc2
■SQL Data :
   Sql Command > DELETE 
FROM 
CCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] 000000
2017/07/31 17:40:22  TRACE> LogicEXTA0101.DelYoyakuCtlData() END
2017/07/31 17:40:22  TRACE> LogicEXTA0101.SetSystemProperties() START
2017/07/31 17:40:22  TRACE> SqlEXTA0101.setSelectSystemProperty() START
2017/07/31 17:40:22  TRACE> SqlEXTA0101.setSelectSystemProperty() END
2017/07/31 17:40:22  DEBUG> LogicEXTA0101.SetSystemProperties() システムプロパティ取得
■SQL Data :
   Sql Command > select 
TEIIN_A, 
TEIIN_B, 
KARI_JIZEN_TUTI, 
GROUP_SEIKYU, 
DAIKO_TANTO_CD, 
DAIKO_BUSHO_CD 
FROM 
SYSTEM_MST 
   Parameters Data > 
2017/07/31 17:40:22  TRACE> LogicEXTA0101.SetSystemProperties() END
2017/07/31 17:40:22  TRACE> EXTA0101.btnLogin_Click() LOGIN:000000
2017/07/31 17:40:22  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:40:22  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:40:37  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:40:37  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:40:38  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:40:38  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:40:38  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:40:42  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:40:42  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:40:48  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:40:48  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:40:48  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:40:48  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:40:48  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:40:48  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:40:48  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:40:48  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:48  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:48  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 01
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 02
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 03
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 04
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 05
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 06
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 07
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 08
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 09
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:49  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:49  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 10
2017/07/31 17:40:50  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:50  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:50  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 11
2017/07/31 17:40:50  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:40:50  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:40:50  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '2'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '1'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 12
2017/07/31 17:40:50  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:40:50  TRACE> LogicEXTZ0104.MakeSpread() END
2017/07/31 17:52:45  TRACE> LogicEXTA0101.GetConfigrationFlg() START
2017/07/31 17:52:45  TRACE> LogicEXTA0101.GetConfigrationFlg() END
2017/07/31 17:52:45  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:52:45  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:52:53  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:52:53  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:52:55  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:52:55  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:52:55  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:52:55  TRACE> LogicEXTA0101.LoginInputCheck() START
2017/07/31 17:52:55  TRACE> LogicEXTA0101.LoginInputCheck() END
2017/07/31 17:52:55  TRACE> LogicEXTA0101.GetLoginData() START
2017/07/31 17:52:55  TRACE> SqlEXTA0101.setSelectLoginData() START
2017/07/31 17:52:55  TRACE> SqlEXTA0101.setSelectLoginData() END
2017/07/31 17:52:55  DEBUG> LogicEXTA0101.GetLoginData() ログイン情報取得
■SQL Data :
   Sql Command > select 
USER_NM, 
MAIL, 
BUSHO_CD, 
SHONIN_FLG, 
MST_FLG 
FROM 
USER_MST 
WHERE
USER_CD = :UserId 
and PW = :Password 
and STS = '0' 
   Parameters Data > 
      [:UserId] 000000
      [:Password] system
2017/07/31 17:52:55  TRACE> LogicEXTA0101.GetLoginData() END
2017/07/31 17:52:55  TRACE> LogicEXTA0101.DelYoyakuCtlData() START
2017/07/31 17:52:55  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc1
■SQL Data :
   Sql Command > DELETE 
FROM 
YCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] 000000
2017/07/31 17:52:55  DEBUG> LogicEXTA0101.DelYoyakuCtlData() Login Proc2
■SQL Data :
   Sql Command > DELETE 
FROM 
CCTL_TBL 
WHERE
USER_CD = :UserId 
   Parameters Data > 
      [:UserId] 000000
2017/07/31 17:52:55  TRACE> LogicEXTA0101.DelYoyakuCtlData() END
2017/07/31 17:52:55  TRACE> LogicEXTA0101.SetSystemProperties() START
2017/07/31 17:52:55  TRACE> SqlEXTA0101.setSelectSystemProperty() START
2017/07/31 17:52:55  TRACE> SqlEXTA0101.setSelectSystemProperty() END
2017/07/31 17:52:55  DEBUG> LogicEXTA0101.SetSystemProperties() システムプロパティ取得
■SQL Data :
   Sql Command > select 
TEIIN_A, 
TEIIN_B, 
KARI_JIZEN_TUTI, 
GROUP_SEIKYU, 
DAIKO_TANTO_CD, 
DAIKO_BUSHO_CD 
FROM 
SYSTEM_MST 
   Parameters Data > 
2017/07/31 17:52:55  TRACE> LogicEXTA0101.SetSystemProperties() END
2017/07/31 17:52:55  TRACE> EXTA0101.btnLogin_Click() LOGIN:000000
2017/07/31 17:52:55  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:52:55  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:53:03  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:53:03  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:53:03  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:53:03  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:53:03  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:53:07  TRACE> CommonLogicEXT.SetFormBackColor() START
2017/07/31 17:53:07  TRACE> CommonLogicEXT.SetFormBackColor() END
2017/07/31 17:53:12  TRACE> CommonLogicEXT.CheckDBCondition() START
2017/07/31 17:53:12  TRACE> CommonLogicEXT.NetUseConect() START
2017/07/31 17:53:12  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:53:12  TRACE> CommonLogicEXT.NetUseConectDel() START
2017/07/31 17:53:12  TRACE> CommonLogicEXT.CheckDBCondition() END
2017/07/31 17:53:12  TRACE> LogicEXTZ0104.MakeSpread() START
2017/07/31 17:53:12  TRACE> LogicEXTZ0104.GetSpreadData() START
2017/07/31 17:53:12  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:12  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:12  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 01
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 02
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 03
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 04
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 05
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 06
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 07
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 08
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 09
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:13  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 10
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:13  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:14  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 11
2017/07/31 17:53:14  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() START
2017/07/31 17:53:14  TRACE> SqlEXTZ0104.setSelectRiyoJokyo() END
2017/07/31 17:53:14  DEBUG> LogicEXTZ0104.GetSpreadData() 
■SQL Data :
   Sql Command >     SELECT
        EXTRACT(DAY FROM (CAST(:HYOJI_NEN ||:HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)))
         - t1.COUNT - t2.COUNT AS RIYO_KANO_NISSU,
        t1.COUNT AS KYUKAN_NISSU,
        t2.COUNT AS MAINTE_NISSU,
        t4a.COUNT AS RIYO_NISSU_CHAKUSEKI,
        t4b.COUNT AS RIYO_NISSU_STANDING,
        t4c.COUNT AS RIYO_NISSU_MIX,
        t4d.COUNT AS RIYO_NISSU_SAIJI,
        t5a.COUNT AS RIYO_NISSU_MUSIC,
        t5b.COUNT AS RIYO_NISSU_ENGEKI,
        t5c.COUNT AS RIYO_NISSU_ENGEI,
        t5d.COUNT AS RIYO_NISSU_BUSINESS,
        t5e.COUNT AS RIYO_NISSU_MOVIE,
        t5f.COUNT AS RIYO_NISSU_SONOTA
    FROM
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '1'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t1
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.HOLMENT_DT) AS COUNT
           FROM
           (
            SELECT
                HOLMENT_DT
            FROM
                HOLMENT_MST
            WHERE
            SHISETU_KBN = '1'
            AND HOLMENT_KBN = '2'
            AND TO_DATE(HOLMENT_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY HOLMENT_DT
           ) TMP
        ) t2
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
            SELECT
                t4a2.YOYAKU_DT
            FROM
                YOYAKU_TBL t4a1
                LEFT JOIN
                    YDT_TBL t4a2
                ON  t4a1.YOYAKU_NO = t4a2.YOYAKU_NO
            WHERE
                t4a1.YOYAKU_STS = '4'
            AND t4a1.SHISETU_KBN = '1'
            AND t4a1.RIYO_TYPE = '1'
            AND TO_DATE(t4a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
            GROUP BY
                t4a2.YOYAKU_DT
           ) TMP
        ) t4a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4b1
                    LEFT JOIN
                        YDT_TBL t4b2
                    ON  t4b1.YOYAKU_NO = t4b2.YOYAKU_NO
                WHERE
                    t4b1.YOYAKU_STS = '4'
                AND t4b1.SHISETU_KBN = '1'
                AND t4b1.RIYO_TYPE = '2'
                AND TO_DATE(t4b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4b2.YOYAKU_DT
           ) TMP
        ) t4b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4c1
                    LEFT JOIN
                        YDT_TBL t4c2
                    ON  t4c1.YOYAKU_NO = t4c2.YOYAKU_NO
                WHERE
                    t4c1.YOYAKU_STS = '4'
                AND t4c1.SHISETU_KBN = '1'
                AND t4c1.RIYO_TYPE = '3'
                AND TO_DATE(t4c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4c2.YOYAKU_DT
           ) TMP
        ) t4c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t4d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t4d1
                    LEFT JOIN
                        YDT_TBL t4d2
                    ON  t4d1.YOYAKU_NO = t4d2.YOYAKU_NO
                WHERE
                    t4d1.YOYAKU_STS = '4'
                AND t4d1.SHISETU_KBN = '1'
                AND t4d1.RIYO_TYPE = '4'
                AND TO_DATE(t4d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t4d2.YOYAKU_DT
           ) TMP
        ) t4d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5a2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5a1
                    LEFT JOIN
                        YDT_TBL t5a2
                    ON  t5a1.YOYAKU_NO = t5a2.YOYAKU_NO
                WHERE
                    t5a1.YOYAKU_STS = '4'
                AND t5a1.SHISETU_KBN = '1'
                AND t5a1.SAIJI_BUNRUI = '1'
                AND TO_DATE(t5a2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5a2.YOYAKU_DT
           ) TMP
         ) t5a
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5b2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5b1
                    LEFT JOIN
                        YDT_TBL t5b2
                    ON  t5b1.YOYAKU_NO = t5b2.YOYAKU_NO
                WHERE
                    t5b1.YOYAKU_STS = '4'
                AND t5b1.SHISETU_KBN = '1'
                AND t5b1.SAIJI_BUNRUI = '2'
                AND TO_DATE(t5b2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5b2.YOYAKU_DT
           ) TMP
         ) t5b
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5c2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5c1
                    LEFT JOIN
                        YDT_TBL t5c2
                    ON  t5c1.YOYAKU_NO = t5c2.YOYAKU_NO
                WHERE
                    t5c1.YOYAKU_STS = '4'
                AND t5c1.SHISETU_KBN = '1'
                AND t5c1.SAIJI_BUNRUI = '3'
                AND TO_DATE(t5c2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5c2.YOYAKU_DT
           ) TMP
         ) t5c
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5d2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5d1
                    LEFT JOIN
                        YDT_TBL t5d2
                    ON  t5d1.YOYAKU_NO = t5d2.YOYAKU_NO
                WHERE
                    t5d1.YOYAKU_STS = '4'
                AND t5d1.SHISETU_KBN = '1'
                AND t5d1.SAIJI_BUNRUI = '4'
                AND TO_DATE(t5d2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5d2.YOYAKU_DT
           ) TMP
         ) t5d
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5e2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5e1
                    LEFT JOIN
                        YDT_TBL t5e2
                    ON  t5e1.YOYAKU_NO = t5e2.YOYAKU_NO
                WHERE
                    t5e1.YOYAKU_STS = '4'
                AND t5e1.SHISETU_KBN = '1'
                AND t5e1.SAIJI_BUNRUI = '5'
                AND TO_DATE(t5e2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5e2.YOYAKU_DT
           ) TMP
         ) t5e
    CROSS JOIN
        (
          SELECT
           COUNT(TMP.YOYAKU_DT) AS COUNT
           FROM
           (
                SELECT
                    t5f2.YOYAKU_DT
                FROM
                    YOYAKU_TBL t5f1
                    LEFT JOIN
                        YDT_TBL t5f2
                    ON  t5f1.YOYAKU_NO = t5f2.YOYAKU_NO
                WHERE
                    t5f1.YOYAKU_STS = '4'
                AND t5f1.SHISETU_KBN = '1'
                AND t5f1.SAIJI_BUNRUI = '6'
                AND TO_DATE(t5f2.YOYAKU_DT, 'YYYY/MM/DD') BETWEEN CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' AS DATE)    
                AND CAST(:HYOJI_NEN || :HYOJI_TSUKI || '01' as date) + cast('1 Month' as interval) - cast('1 day' as interval)
                GROUP BY
                    t5f2.YOYAKU_DT
           ) TMP
        ) t5f
   Parameters Data > 
      [:HYOJI_NEN] 2016
      [:HYOJI_TSUKI] 12
2017/07/31 17:53:14  TRACE> LogicEXTZ0104.GetSpreadData() END
2017/07/31 17:53:14  TRACE> LogicEXTZ0104.MakeSpread() END
